# AI Agent Platform - ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ë³„ ê¸°ìˆ  ìƒí˜¸ì‘ìš©

**ì‘ì„±ì¼**: 2025ë…„ 8ì›” 20ì¼  
**ëª©ì **: ì‚¬ìš©ìì˜ ëª¨ë“  í–‰ë™ì´ ì–´ë–¤ ê¸°ìˆ ë“¤ì„ ê±°ì³ ì²˜ë¦¬ë˜ëŠ”ì§€ ìƒì„¸ ë¶„ì„

---

## ğŸ¯ ê°œìš”

ì´ ë¬¸ì„œëŠ” AI Agent Platformì—ì„œ ì‚¬ìš©ìê°€ ìˆ˜í–‰í•˜ëŠ” ëª¨ë“  ì‘ì—…ì´ ë°±ì—”ë“œ ê¸°ìˆ  ìŠ¤íƒì„ í†µí•´ ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ì§€ë¥¼ ë‹¨ê³„ë³„ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤. ê° ì‚¬ìš©ì í–‰ë™ì— ëŒ€í•´ ê´€ë ¨ëœ ê¸°ìˆ ë“¤ì´ ì–´ë–¤ ìˆœì„œë¡œ, ì–´ë–¤ ì—­í• ì„ í•˜ë©° ìƒí˜¸ì‘ìš©í•˜ëŠ”ì§€ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**í”Œë«í¼ URL**: http://34.64.193.42/static/dashboard.html

---

## ğŸ­ ì‹œë‚˜ë¦¬ì˜¤ 1: ìƒˆ ì‚¬ìš©ìê°€ ì²« ë²ˆì§¸ ì—ì´ì „íŠ¸ë¥¼ ë§Œë“œëŠ” ê³¼ì •

### ğŸ“± 1ë‹¨ê³„: ì›¹ì‚¬ì´íŠ¸ ì ‘ì†

**ì‚¬ìš©ì í–‰ë™**: ë¸Œë¼ìš°ì €ì— `http://34.64.193.42/static/dashboard.html` ì…ë ¥ í›„ ì—”í„°

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ë¸Œë¼ìš°ì € DNS ì¡°íšŒ
    â†“
ì¸í„°ë„· ë¼ìš°íŒ… (ì „ ì„¸ê³„ â†’ í•œêµ­ GCP ë°ì´í„°ì„¼í„°)
    â†“ 
GCP LoadBalancer (34.64.193.42)
    â”œâ”€ íŠ¸ë˜í”½ ìˆ˜ì‹  ë° ë¶„ì„
    â”œâ”€ DDoS ë³´í˜¸ ì‹œìŠ¤í…œ í™•ì¸
    â””â”€ ìµœì  Pod ì„ íƒ ì•Œê³ ë¦¬ì¦˜ ì‹¤í–‰
    â†“
Kubernetes Service (ai-agent-service)
    â”œâ”€ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Pod ìƒíƒœ í™•ì¸
    â”œâ”€ í—¬ìŠ¤ì²´í¬ ê²°ê³¼ ê²€í† 
    â””â”€ ê°€ì¥ ì—¬ìœ ë¡œìš´ Pod ì„ íƒ
    â†“
Kubernetes Pod (ai-agent-api-74d86c596b-pws69)
    â”œâ”€ ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ìƒíƒœ í™•ì¸
    â”œâ”€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: í˜„ì¬ ì‚¬ìš©ëŸ‰ ì²´í¬
    â””â”€ CPU ì‚¬ìš©ë¥ : í˜„ì¬ ë¶€í•˜ í™•ì¸
    â†“
FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ (main.py)
    â”œâ”€ HTTP GET ìš”ì²­ ìˆ˜ì‹ 
    â”œâ”€ ì •ì  íŒŒì¼ ì„œë¹™ ëª¨ë“ˆ í˜¸ì¶œ
    â”œâ”€ dashboard.html íŒŒì¼ ìœ„ì¹˜ í™•ì¸
    â”œâ”€ íŒŒì¼ ê¶Œí•œ ë° ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    â””â”€ HTTP 200 ì‘ë‹µ ìƒì„±
    â†“
ë¸Œë¼ìš°ì €
    â”œâ”€ HTML íŒŒì‹± ë° ë Œë”ë§
    â”œâ”€ CSS ìŠ¤íƒ€ì¼ ì ìš©
    â””â”€ JavaScript ì‹¤í–‰ ì‹œì‘
```

**ì†Œìš” ì‹œê°„**: í‰ê·  500ms
**ë¦¬ì†ŒìŠ¤ ì‚¬ìš©**: ë©”ëª¨ë¦¬ 2MB, CPU 0.1ì´ˆ

### ğŸ” 2ë‹¨ê³„: ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ìë™ ìƒì„±

**ì‚¬ìš©ì í–‰ë™**: ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ë¡œë”© ì™„ë£Œ (ìë™ ì‹¤í–‰)

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ë¸Œë¼ìš°ì € JavaScript
    â”œâ”€ DOM ë¡œë”© ì™„ë£Œ ì´ë²¤íŠ¸ ê°ì§€
    â”œâ”€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ê¸°ì¡´ ì„¸ì…˜ í™•ì¸
    â”œâ”€ ì„¸ì…˜ ì—†ìŒ í™•ì¸
    â””â”€ AJAX ìš”ì²­ ìƒì„±
    â†“
XMLHttpRequest â†’ LoadBalancer â†’ Pod â†’ FastAPI
    â†“
FastAPI /api/auth/guest ì—”ë“œí¬ì¸íŠ¸
    â”œâ”€ ìš”ì²­ í—¤ë” ë¶„ì„ (User-Agent, IP ë“±)
    â”œâ”€ auth.py ëª¨ë“ˆ í˜¸ì¶œ
    â””â”€ create_guest_session() í•¨ìˆ˜ ì‹¤í–‰
    â†“
auth.py (auth_manager)
    â”œâ”€ UUID ê¸°ë°˜ ê³ ìœ  ì„¸ì…˜ ID ìƒì„±
    â”œâ”€ í˜„ì¬ ì‹œê°„ ê¸°ë¡ (createdAt, expiresAt)
    â”œâ”€ ì‚¬ìš©ì íƒ€ì… 'guest' ì„¤ì •
    â””â”€ ì„¸ì…˜ ë°ì´í„° ê°ì²´ ìƒì„±
    â†“
Firestore ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼
    â”œâ”€ Workload Identity ê¶Œí•œ í™•ì¸
    â”œâ”€ ai-agent-gke-sa ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ ì¸ì¦
    â”œâ”€ 'sessions' ì»¬ë ‰ì…˜ ì ‘ê·¼
    â”œâ”€ ìƒˆ ë„íë¨¼íŠ¸ ìƒì„±
    â””â”€ ì„¸ì…˜ ë°ì´í„° ì €ì¥ (ì•”í˜¸í™”)
    â†“
ì‘ë‹µ ìƒì„± ë° ì „ì†¡
    â”œâ”€ JSON í˜•íƒœë¡œ ì„¸ì…˜ ì •ë³´ ì§ë ¬í™”
    â”œâ”€ HTTP 200 ì‘ë‹µ ìƒì„±
    â””â”€ ë¸Œë¼ìš°ì €ë¡œ ì „ì†¡
    â†“
ë¸Œë¼ìš°ì € JavaScript
    â”œâ”€ ì‘ë‹µ JSON íŒŒì‹±
    â”œâ”€ ì„¸ì…˜ ID ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥
    â”œâ”€ ì‚¬ìš©ì ID ì „ì—­ ë³€ìˆ˜ ì„¤ì •
    â””â”€ UI ì—…ë°ì´íŠ¸ (ë¡œê·¸ì¸ ìƒíƒœ í‘œì‹œ)
```

**ì†Œìš” ì‹œê°„**: í‰ê·  300ms
**ë°ì´í„° í¬ê¸°**: ì„¸ì…˜ ì •ë³´ ~200B

### ğŸ¤– 3ë‹¨ê³„: ìƒˆ ì—ì´ì „íŠ¸ ìƒì„± ë²„íŠ¼ í´ë¦­

**ì‚¬ìš©ì í–‰ë™**: "ìƒˆ ì—ì´ì „íŠ¸ ë§Œë“¤ê¸°" ë²„íŠ¼ í´ë¦­

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ë¸Œë¼ìš°ì € ì´ë²¤íŠ¸ ì²˜ë¦¬
    â”œâ”€ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ê°ì§€
    â”œâ”€ ì—ì´ì „íŠ¸ ìƒì„± ëª¨ë‹¬ ì°½ í‘œì‹œ
    â””â”€ ì‚¬ìš©ì ì…ë ¥ ëŒ€ê¸°
    â†“
ì‚¬ìš©ì ì…ë ¥ ì™„ë£Œ (ì´ë¦„, ì„¤ëª…, íƒœê·¸ ë“±)
    â”œâ”€ í¼ ìœ íš¨ì„± ê²€ì‚¬ (JavaScript)
    â”œâ”€ í•„ìˆ˜ í•„ë“œ í™•ì¸
    â””â”€ ë°ì´í„° ê²€ì¦ ì™„ë£Œ
    â†“
AJAX POST ìš”ì²­ ìƒì„±
    â”œâ”€ JSON í˜ì´ë¡œë“œ ìƒì„±
    â”œâ”€ X-User-Id í—¤ë” ì¶”ê°€ (ì„¸ì…˜ ID)
    â””â”€ Content-Type: application/json ì„¤ì •
    â†“
LoadBalancer â†’ Kubernetes Service â†’ Pod â†’ FastAPI
    â†“
FastAPI /api/agents POST ì—”ë“œí¬ì¸íŠ¸
    â”œâ”€ HTTP POST ìš”ì²­ ìˆ˜ì‹ 
    â”œâ”€ í—¤ë”ì—ì„œ X-User-Id ì¶”ì¶œ
    â”œâ”€ ìš”ì²­ ë³¸ë¬¸ JSON íŒŒì‹±
    â””â”€ create_agent() í•¨ìˆ˜ í˜¸ì¶œ
    â†“
Pydantic ë°ì´í„° ê²€ì¦
    â”œâ”€ AgentCreateRequest ëª¨ë¸ ê²€ì¦
    â”œâ”€ í•„ë“œ íƒ€ì… í™•ì¸ (name: str, tags: List[str])
    â”œâ”€ ê°’ ì œí•œ í™•ì¸ (ë¬¸ìì—´ ê¸¸ì´ ë“±)
    â””â”€ ê²€ì¦ í†µê³¼
    â†“
Firestore ë°ì´í„° ì €ì¥
    â”œâ”€ Workload Identity ê¶Œí•œ ì¬í™•ì¸
    â”œâ”€ 'agents' ì»¬ë ‰ì…˜ ì ‘ê·¼
    â”œâ”€ ìƒˆ ë„íë¨¼íŠ¸ ì°¸ì¡° ìƒì„±
    â”œâ”€ ì—ì´ì „íŠ¸ ë°ì´í„° ê°ì²´ êµ¬ì„±:
    â”‚   â”œâ”€ ê¸°ë³¸ í•„ë“œ (name, description, tags)
    â”‚   â”œâ”€ ì‹œìŠ¤í…œ í•„ë“œ (userId, createdAt, status)
    â”‚   â”œâ”€ ë©”íƒ€ë°ì´í„° (totalRuns: 0, successfulRuns: 0)
    â”‚   â””â”€ ì¶”ê°€ í•„ë“œ (color, icon, finalPrompt)
    â”œâ”€ ë„íë¨¼íŠ¸ ì €ì¥ (íŠ¸ëœì­ì…˜ ì²˜ë¦¬)
    â””â”€ ìë™ ID ìƒì„± ë° ë°˜í™˜
    â†“
ì„±ê³µ ì‘ë‹µ ìƒì„±
    â”œâ”€ ì €ì¥ëœ ì—ì´ì „íŠ¸ ë°ì´í„° ì§ë ¬í™”
    â”œâ”€ ìƒì„±ëœ ID í¬í•¨
    â”œâ”€ HTTP 201 Created ì‘ë‹µ
    â””â”€ JSON í˜•íƒœë¡œ ì‘ë‹µ
    â†“
ë¸Œë¼ìš°ì € ì„±ê³µ ì²˜ë¦¬
    â”œâ”€ 201 ì‘ë‹µ ì½”ë“œ í™•ì¸
    â”œâ”€ ì‘ë‹µ JSON íŒŒì‹±
    â”œâ”€ ì—ì´ì „íŠ¸ ëª©ë¡ì— ìƒˆ í•­ëª© ì¶”ê°€
    â”œâ”€ ëª¨ë‹¬ ì°½ ë‹«ê¸°
    â””â”€ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
```

**ì†Œìš” ì‹œê°„**: í‰ê·  800ms
**ìƒì„±ëœ ë°ì´í„°**: ì—ì´ì „íŠ¸ ë¬¸ì„œ ~1KB

### ğŸ’¬ 4ë‹¨ê³„: ì—ì´ì „íŠ¸ì™€ ì‹¤ì‹œê°„ ëŒ€í™” ì‹œì‘

**ì‚¬ìš©ì í–‰ë™**: ìƒì„±ëœ ì—ì´ì „íŠ¸ ì¹´ë“œì—ì„œ "ëŒ€í™” ì‹œì‘" ë²„íŠ¼ í´ë¦­

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ë¸Œë¼ìš°ì € WebSocket ì—°ê²° ìš”ì²­
    â”œâ”€ WebSocket ê°ì²´ ìƒì„±
    â”œâ”€ ì—°ê²° URL êµ¬ì„±: ws://34.64.193.42/workspace/{user_id}
    â””â”€ ì—°ê²° ìš”ì²­ ì „ì†¡
    â†“
LoadBalancer WebSocket ì²˜ë¦¬
    â”œâ”€ HTTP â†’ WebSocket í”„ë¡œí† ì½œ ì—…ê·¸ë ˆì´ë“œ
    â”œâ”€ ì—°ê²° ìƒíƒœ ê´€ë¦¬ ì‹œì‘
    â””â”€ ë°±ì—”ë“œ Podìœ¼ë¡œ ì „ë‹¬
    â†“
FastAPI WebSocket ì—”ë“œí¬ì¸íŠ¸
    â”œâ”€ WebSocket ì—°ê²° ìˆ˜ë½
    â”œâ”€ user_workspace() í•¨ìˆ˜ ì‹¤í–‰
    â””â”€ ConnectionManagerì— ì‚¬ìš©ì ë“±ë¡
    â†“
ConnectionManager.connect()
    â”œâ”€ active_connections ë”•ì…”ë„ˆë¦¬ì— ì¶”ê°€
    â”œâ”€ UserWorkspace ê°ì²´ ìƒì„±
    â”œâ”€ user_workspaces ë”•ì…”ë„ˆë¦¬ì— ì¶”ê°€
    â””â”€ ì—°ê²° ì„±ê³µ ë¡œê·¸ ê¸°ë¡
    â†“
í™˜ì˜ ë©”ì‹œì§€ ì „ì†¡
    â”œâ”€ ì‹œìŠ¤í…œ ë©”ì‹œì§€ ê°ì²´ ìƒì„±
    â”œâ”€ í˜„ì¬ ì‹œê°„ íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€
    â”œâ”€ JSON ì§ë ¬í™”
    â””â”€ WebSocketìœ¼ë¡œ ì „ì†¡
    â†“
ì‚¬ìš©ì ë©”ì‹œì§€ ì…ë ¥ ë° ì „ì†¡
    â”œâ”€ ë¸Œë¼ìš°ì €ì—ì„œ í…ìŠ¤íŠ¸ ì…ë ¥
    â”œâ”€ Enter í‚¤ ë˜ëŠ” ì „ì†¡ ë²„íŠ¼ í´ë¦­
    â”œâ”€ ë©”ì‹œì§€ JSON êµ¬ì„±
    â””â”€ WebSocketìœ¼ë¡œ ì „ì†¡
    â†“
FastAPI ë©”ì‹œì§€ ì²˜ë¦¬
    â”œâ”€ WebSocketì—ì„œ í…ìŠ¤íŠ¸ ìˆ˜ì‹ 
    â”œâ”€ JSON íŒŒì‹±
    â”œâ”€ ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ì¶œ
    â””â”€ process_user_message() í˜¸ì¶œ
    â†“
UserWorkspace.send_to_claude()
    â”œâ”€ DISABLE_DOCKER í™˜ê²½ ë³€ìˆ˜ í™•ì¸
    â”œâ”€ Docker ë¹„í™œì„±í™” ìƒíƒœ í™•ì¸
    â”œâ”€ ì‹œë®¬ë ˆì´ì…˜ ì‘ë‹µ ìƒì„±:
    â”‚   â”œâ”€ í‘œì¤€ ë©”ì‹œì§€ í…œí”Œë¦¿ ì‚¬ìš©
    â”‚   â”œâ”€ ì‚¬ìš©ì ë©”ì‹œì§€ ë‚´ìš© í¬í•¨
    â”‚   â””â”€ Kubernetes í™˜ê²½ ì•ˆë‚´ ì¶”ê°€
    â””â”€ ì‘ë‹µ ë¬¸ìì—´ ë°˜í™˜
    â†“
ëŒ€í™” ê¸°ë¡ Firestore ì €ì¥
    â”œâ”€ _save_conversation() í•¨ìˆ˜ í˜¸ì¶œ
    â”œâ”€ 'conversations' ì»¬ë ‰ì…˜ ì ‘ê·¼
    â”œâ”€ ëŒ€í™” ë°ì´í„° êµ¬ì„±:
    â”‚   â”œâ”€ userId, agentId, createdAt
    â”‚   â”œâ”€ messages ë°°ì—´ (user + assistant)
    â”‚   â””â”€ íƒ€ì„ìŠ¤íƒ¬í”„ ì •ë³´
    â”œâ”€ ë„íë¨¼íŠ¸ ì €ì¥
    â””â”€ ì €ì¥ ì™„ë£Œ í™•ì¸
    â†“
ì‹¤ì‹œê°„ ì‘ë‹µ ì „ì†¡
    â”œâ”€ ì‘ë‹µ ë©”ì‹œì§€ ê°ì²´ ìƒì„±
    â”œâ”€ JSON ì§ë ¬í™”
    â”œâ”€ WebSocketìœ¼ë¡œ ì¦‰ì‹œ ì „ì†¡
    â””â”€ ë¸Œë¼ìš°ì €ì—ì„œ ì¦‰ì‹œ í‘œì‹œ
```

**ì†Œìš” ì‹œê°„**: ë©”ì‹œì§€ë‹¹ í‰ê·  200ms
**ë°ì´í„° ì €ì¥**: ëŒ€í™” 1í„´ë‹¹ ~500B

---

## ğŸ” ì‹œë‚˜ë¦¬ì˜¤ 2: ê¸°ì¡´ ì‚¬ìš©ìê°€ ì—ì´ì „íŠ¸ ëª©ë¡ì„ ì¡°íšŒí•˜ëŠ” ê³¼ì •

### ğŸ”„ 1ë‹¨ê³„: ì›¹ì‚¬ì´íŠ¸ ì¬ì ‘ì† ë° ìë™ ë¡œê·¸ì¸

**ì‚¬ìš©ì í–‰ë™**: ë¸Œë¼ìš°ì €ì—ì„œ ë¶ë§ˆí¬ë‚˜ íˆìŠ¤í† ë¦¬ë¡œ ëŒ€ì‹œë³´ë“œ ì¬ì ‘ì†

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ë¸Œë¼ìš°ì € í˜ì´ì§€ ë¡œë”©
    â”œâ”€ HTML/CSS/JS ìºì‹œ í™•ì¸
    â”œâ”€ ìºì‹œëœ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© (ë¹ ë¥¸ ë¡œë”©)
    â””â”€ JavaScript ì‹¤í–‰ ì‹œì‘
    â†“
ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í™•ì¸
    â”œâ”€ sessionId ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    â”œâ”€ ì„¸ì…˜ ë§Œë£Œ ì‹œê°„ í™•ì¸
    â””â”€ ìœ íš¨í•œ ì„¸ì…˜ ë°œê²¬
    â†“
ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦ ìš”ì²­
    â”œâ”€ GET /api/auth/validate/{session_id} í˜¸ì¶œ
    â”œâ”€ ì„¸ì…˜ IDë¥¼ URL íŒŒë¼ë¯¸í„°ë¡œ ì „ì†¡
    â””â”€ ì„œë²„ ê²€ì¦ ëŒ€ê¸°
    â†“
FastAPI ì„¸ì…˜ ê²€ì¦
    â”œâ”€ validate_session() í•¨ìˆ˜ ì‹¤í–‰
    â”œâ”€ auth_manager.validate_session() í˜¸ì¶œ
    â””â”€ ì„¸ì…˜ ìƒíƒœ í™•ì¸
    â†“
Firestore ì„¸ì…˜ ì¡°íšŒ
    â”œâ”€ 'sessions' ì»¬ë ‰ì…˜ì—ì„œ ë„íë¨¼íŠ¸ ê²€ìƒ‰
    â”œâ”€ ì„¸ì…˜ ë§Œë£Œ ì‹œê°„ í™•ì¸
    â”œâ”€ ì„¸ì…˜ í™œì„± ìƒíƒœ í™•ì¸
    â””â”€ ìœ íš¨ì„± íŒì •
    â†“
ìë™ ë¡œê·¸ì¸ ì™„ë£Œ
    â”œâ”€ ìœ íš¨í•œ ì„¸ì…˜ ì‘ë‹µ (HTTP 200)
    â”œâ”€ ì‚¬ìš©ì ì •ë³´ ë°˜í™˜
    â””â”€ UI ìë™ ì—…ë°ì´íŠ¸
```

### ğŸ“‹ 2ë‹¨ê³„: ì—ì´ì „íŠ¸ ëª©ë¡ ìë™ ì¡°íšŒ

**ì‚¬ìš©ì í–‰ë™**: ëŒ€ì‹œë³´ë“œ ë¡œë”© ì™„ë£Œ (ìë™ ì‹¤í–‰)

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
    â”œâ”€ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì´ë²¤íŠ¸
    â”œâ”€ ì—ì´ì „íŠ¸ ëª©ë¡ ë¡œë”© í•¨ìˆ˜ í˜¸ì¶œ
    â””â”€ GET /api/agents ìš”ì²­ ìƒì„±
    â†“
LoadBalancer ìš”ì²­ ë¶„ë°°
    â”œâ”€ í˜„ì¬ í™œì„± Pod ëª©ë¡ í™•ì¸
    â”œâ”€ ê° Podì˜ í˜„ì¬ ì—°ê²° ìˆ˜ ì²´í¬
    â”œâ”€ CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ê³ ë ¤
    â””â”€ ìµœì  Pod ì„ íƒ ë° ë¼ìš°íŒ…
    â†“
Kubernetes Service ë¼ìš°íŒ…
    â”œâ”€ ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
    â”œâ”€ Pod IP ë° í¬íŠ¸ í™•ì¸
    â”œâ”€ í—¬ìŠ¤ì²´í¬ ìƒíƒœ í™•ì¸
    â””â”€ ì„ íƒëœ Podìœ¼ë¡œ ìš”ì²­ ì „ë‹¬
    â†“
FastAPI list_agents() ì—”ë“œí¬ì¸íŠ¸
    â”œâ”€ HTTP GET ìš”ì²­ ìˆ˜ì‹ 
    â”œâ”€ X-User-Id í—¤ë” ì¶”ì¶œ
    â”œâ”€ í—¤ë” ìœ íš¨ì„± í™•ì¸
    â””â”€ ì—ì´ì „íŠ¸ ì¡°íšŒ ë¡œì§ ì‹¤í–‰
    â†“
Workload Identity ê¶Œí•œ í™•ì¸
    â”œâ”€ ai-agent-ksa Kubernetes ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸
    â”œâ”€ ai-agent-gke-sa GCP ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ì™€ ë°”ì¸ë”©
    â”œâ”€ roles/datastore.user ê¶Œí•œ í™•ì¸
    â””â”€ Firestore ì ‘ê·¼ ê¶Œí•œ íšë“
    â†“
Firestore ì¿¼ë¦¬ ì‹¤í–‰
    â”œâ”€ db.collection('agents') ì ‘ê·¼
    â”œâ”€ .where('userId', '==', user_id) í•„í„° ì ìš©
    â”œâ”€ ì¸ë±ìŠ¤ ê¸°ë°˜ ë¹ ë¥¸ ê²€ìƒ‰
    â”œâ”€ ì¿¼ë¦¬ ê²°ê³¼ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬
    â””â”€ ë„íë¨¼íŠ¸ ë¦¬ìŠ¤íŠ¸ ìƒì„±
    â†“
ë°ì´í„° ë³€í™˜ ë° ì§ë ¬í™”
    â”œâ”€ ê° ë„íë¨¼íŠ¸ë¥¼ ë”•ì…”ë„ˆë¦¬ë¡œ ë³€í™˜
    â”œâ”€ ë„íë¨¼íŠ¸ ID ì¶”ê°€ (id í•„ë“œ)
    â”œâ”€ ë‚ ì§œ ê°ì²´ ISO ë¬¸ìì—´ ë³€í™˜
    â”œâ”€ JSON ì§ë ¬í™”
    â””â”€ HTTP ì‘ë‹µ ìƒì„±
    â†“
ë¸Œë¼ìš°ì € ì‘ë‹µ ì²˜ë¦¬
    â”œâ”€ JSON ì‘ë‹µ íŒŒì‹±
    â”œâ”€ ì—ì´ì „íŠ¸ ë°°ì—´ ì¶”ì¶œ
    â”œâ”€ DOM ì—…ë°ì´íŠ¸ (ì—ì´ì „íŠ¸ ì¹´ë“œ ìƒì„±)
    â”œâ”€ ë¡œë”© ìƒíƒœ ì œê±°
    â””â”€ ì‚¬ìš©ìì—ê²Œ ëª©ë¡ í‘œì‹œ
```

**ì†Œìš” ì‹œê°„**: í‰ê·  400ms
**ë°˜í™˜ ë°ì´í„°**: ì—ì´ì „íŠ¸ 10ê°œ ê¸°ì¤€ ~10KB

---

## âš¡ ì‹œë‚˜ë¦¬ì˜¤ 3: ì‹œìŠ¤í…œì´ ì‚¬ìš©ì ê¸‰ì¦ì— ìë™ ëŒ€ì‘í•˜ëŠ” ê³¼ì •

### ğŸ“ˆ 1ë‹¨ê³„: íŠ¸ë˜í”½ ì¦ê°€ ê°ì§€

**ìƒí™©**: í‰ì†Œ ë™ì‹œ ì ‘ì†ì 10ëª… â†’ ê°‘ìê¸° 30ëª…ìœ¼ë¡œ ê¸‰ì¦

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
LoadBalancer ëª¨ë‹ˆí„°ë§
    â”œâ”€ ì´ˆë‹¹ ìš”ì²­ ìˆ˜ ì¦ê°€ ê°ì§€ (10 RPS â†’ 30 RPS)
    â”œâ”€ í‰ê·  ì‘ë‹µ ì‹œê°„ ì¦ê°€ ê°ì§€ (200ms â†’ 800ms)
    â”œâ”€ ì—°ê²° í ê¸¸ì´ ì¦ê°€ ê°ì§€
    â””â”€ ë°±ì—”ë“œ Pod ìƒíƒœ í™•ì¸ ìš”ì²­
    â†“
Kubernetes Metrics Server
    â”œâ”€ ê° Podì˜ CPU ì‚¬ìš©ë¥  ìˆ˜ì§‘
    â”œâ”€ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ìˆ˜ì§‘
    â”œâ”€ ë„¤íŠ¸ì›Œí¬ I/O í†µê³„ ìˆ˜ì§‘
    â””â”€ ë©”íŠ¸ë¦­ ë°ì´í„° HPAì— ì „ë‹¬
    â†“
HPA (Horizontal Pod Autoscaler) ë¶„ì„
    â”œâ”€ í˜„ì¬ Pod: 1ê°œ ì‹¤í–‰ ì¤‘
    â”œâ”€ í‰ê·  CPU ì‚¬ìš©ë¥ : 85% (ëª©í‘œ: 80%)
    â”œâ”€ ìŠ¤ì¼€ì¼ë§ í•„ìš”ì„± íŒë‹¨
    â”œâ”€ ìŠ¤ì¼€ì¼ë§ ì •ì±… í™•ì¸:
    â”‚   â”œâ”€ minReplicas: 1
    â”‚   â”œâ”€ maxReplicas: 3
    â”‚   â””â”€ targetCPUUtilizationPercentage: 80
    â””â”€ ìŠ¤ì¼€ì¼ ì•„ì›ƒ ê²°ì • (1 â†’ 2 Pod)
```

### ğŸš€ 2ë‹¨ê³„: ìë™ ìŠ¤ì¼€ì¼ë§ ì‹¤í–‰

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
HPA ìŠ¤ì¼€ì¼ë§ ëª…ë ¹
    â”œâ”€ Kubernetes API ì„œë²„ì— ìŠ¤ì¼€ì¼ë§ ìš”ì²­
    â”œâ”€ Deployment ìŠ¤í™ ì—…ë°ì´íŠ¸ (replicas: 1 â†’ 2)
    â””â”€ ReplicaSet ì»¨íŠ¸ë¡¤ëŸ¬ì— ë³€ê²½ í†µì§€
    â†“
Kubernetes ìŠ¤ì¼€ì¤„ëŸ¬
    â”œâ”€ ìƒˆ Pod ìƒì„± í•„ìš”ì„± í™•ì¸
    â”œâ”€ í´ëŸ¬ìŠ¤í„° ë…¸ë“œ ë¦¬ì†ŒìŠ¤ í™•ì¸
    â”œâ”€ GKE Autopilot ë…¸ë“œ ì„ íƒ/ìƒì„±
    â”œâ”€ Pod ìŠ¤ì¼€ì¤„ë§ ê²°ì •
    â””â”€ ë…¸ë“œì— Pod ë°°ì¹˜ ëª…ë ¹
    â†“
GKE Autopilot ë…¸ë“œ ê´€ë¦¬
    â”œâ”€ ê¸°ì¡´ ë…¸ë“œ ë¦¬ì†ŒìŠ¤ í™•ì¸
    â”œâ”€ ìƒˆ Pod ìˆ˜ìš© ê°€ëŠ¥ì„± íŒë‹¨
    â”œâ”€ í•„ìš”ì‹œ ìƒˆ ë…¸ë“œ ìë™ ìƒì„±
    â””â”€ ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ í• ë‹¹
    â†“
ìƒˆ Pod ìƒì„± ê³¼ì •
    â”œâ”€ Pod ìŠ¤í™ ì ìš© (deployment.yaml)
    â”œâ”€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ í’€:
    â”‚   â”œâ”€ gcr.io/ai-agent-platform-469401/api-server:v1.3-amd64
    â”‚   â”œâ”€ ì´ë¯¸ì§€ ë ˆì´ì–´ ë‹¤ìš´ë¡œë“œ
    â”‚   â””â”€ ì´ë¯¸ì§€ ìºì‹œ í™•ì¸
    â”œâ”€ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ í™˜ê²½ ì„¤ì •:
    â”‚   â”œâ”€ ë©”ëª¨ë¦¬ ì œí•œ: 2Gi
    â”‚   â”œâ”€ CPU ì œí•œ: 1000m
    â”‚   â””â”€ í™˜ê²½ ë³€ìˆ˜ ì£¼ì…
    â””â”€ ì»¨í…Œì´ë„ˆ ì‹œì‘
    â†“
Secret Manager ê¶Œí•œ ì„¤ì •
    â”œâ”€ ìƒˆ Podì— Workload Identity ì ìš©
    â”œâ”€ ai-agent-ksa ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ ë°”ì¸ë”©
    â”œâ”€ Secret Managerì—ì„œ API í‚¤ ìë™ ì£¼ì…:
    â”‚   â”œâ”€ ANTHROPIC_API_KEY ê°’ ì¡°íšŒ
    â”‚   â”œâ”€ Pod í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •
    â”‚   â””â”€ ë³´ì•ˆ ê¶Œí•œ í™•ì¸
    â””â”€ Firestore ì ‘ê·¼ ê¶Œí•œ ìë™ ì„¤ì •
    â†“
ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™”
    â”œâ”€ FastAPI ì„œë²„ ì‹œì‘
    â”œâ”€ Firestore í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
    â”œâ”€ Docker í´ë¼ì´ì–¸íŠ¸ í™•ì¸ (DISABLE_DOCKER=true)
    â”œâ”€ ì •ì  íŒŒì¼ ì„œë¹™ ì¤€ë¹„
    â”œâ”€ Health Check ì—”ë“œí¬ì¸íŠ¸ í™œì„±í™”
    â””â”€ ì„œë²„ Ready ìƒíƒœ ì „í™˜
```

### ğŸ”„ 3ë‹¨ê³„: íŠ¸ë˜í”½ ìë™ ë¶„ì‚°

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
LoadBalancer ë°±ì—”ë“œ í’€ ì—…ë°ì´íŠ¸
    â”œâ”€ Kubernetes Serviceì—ì„œ ìƒˆ Pod IP ê°ì§€
    â”œâ”€ ìƒˆ Pod í—¬ìŠ¤ì²´í¬ í™•ì¸:
    â”‚   â”œâ”€ GET /health ìš”ì²­ ì „ì†¡
    â”‚   â”œâ”€ HTTP 200 ì‘ë‹µ í™•ì¸
    â”‚   â””â”€ ì—°ì† 3íšŒ ì„±ê³µ ëŒ€ê¸°
    â”œâ”€ ë°±ì—”ë“œ í’€ì— ìƒˆ Pod ì¶”ê°€
    â””â”€ íŠ¸ë˜í”½ ë¶„ì‚° ì•Œê³ ë¦¬ì¦˜ ì—…ë°ì´íŠ¸
    â†“
íŠ¸ë˜í”½ ë¶„ì‚° ì‹¤í–‰
    â”œâ”€ ë¼ìš´ë“œ ë¡œë¹ˆ ì•Œê³ ë¦¬ì¦˜ ì ìš©
    â”œâ”€ ìƒˆ ìš”ì²­ì„ 2ê°œ Podì— 50:50 ë¶„ë°°
    â”œâ”€ ê¸°ì¡´ WebSocket ì—°ê²° ìœ ì§€ (ì„¸ì…˜ ìŠ¤í‹°í‚¤)
    â””â”€ ìƒˆ ì—°ê²°ì€ ìµœì†Œ ë¶€í•˜ Podë¡œ ë¼ìš°íŒ…
    â†“
Firestore ì—°ê²° ê³µìœ 
    â”œâ”€ ëª¨ë“  Podê°€ ë™ì¼í•œ Firestore ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©
    â”œâ”€ ì—°ê²° í’€ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬
    â”œâ”€ ì‚¬ìš©ì ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
    â””â”€ ë™ì‹œì„± ì œì–´ (Firestore ìë™ ì²˜ë¦¬)
    â†“
ì‚¬ìš©ì ê²½í—˜ ìµœì í™”
    â”œâ”€ ê¸°ì¡´ ì‚¬ìš©ì: ì—°ê²° ì¤‘ë‹¨ ì—†ìŒ
    â”œâ”€ ìƒˆ ì‚¬ìš©ì: ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„ í™•ë³´
    â”œâ”€ ì „ì²´ ì‹œìŠ¤í…œ ì‘ë‹µì„± í–¥ìƒ
    â””â”€ ì„œë¹„ìŠ¤ í’ˆì§ˆ ìœ ì§€
```

### ğŸ“‰ 4ë‹¨ê³„: íŠ¸ë˜í”½ ê°ì†Œ ì‹œ ìë™ ì¶•ì†Œ

**ìƒí™©**: ì‚¬ìš©ì ìˆ˜ê°€ ë‹¤ì‹œ 10ëª…ìœ¼ë¡œ ê°ì†Œ

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
HPA ì¶•ì†Œ ì¡°ê±´ ê°ì§€
    â”œâ”€ í‰ê·  CPU ì‚¬ìš©ë¥ : 40% (ëª©í‘œ: 80%)
    â”œâ”€ ì§€ì† ì‹œê°„: 5ë¶„ ì´ìƒ ì €ì‚¬ìš©ë¥  ìœ ì§€
    â”œâ”€ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ì¿¨ë‹¤ìš´ í™•ì¸ (15ë¶„)
    â””â”€ ì¶•ì†Œ ê²°ì • (2 Pod â†’ 1 Pod)
    â†“
ì•ˆì „í•œ Pod ì¢…ë£Œ ê³¼ì •
    â”œâ”€ ì¢…ë£Œí•  Pod ì„ íƒ (ê°€ì¥ ìµœê·¼ ìƒì„±ëœ Pod)
    â”œâ”€ ìƒˆ ì—°ê²° ì°¨ë‹¨ (LoadBalancerì—ì„œ ì œê±°)
    â”œâ”€ ê¸°ì¡´ ì—°ê²° ë“œë ˆì´ë‹ (30ì´ˆ ëŒ€ê¸°)
    â”œâ”€ SIGTERM ì‹ í˜¸ ì „ì†¡
    â”œâ”€ ì• í”Œë¦¬ì¼€ì´ì…˜ Graceful Shutdown
    â””â”€ ë¦¬ì†ŒìŠ¤ í•´ì œ ë° Pod ì‚­ì œ
    â†“
ë¦¬ì†ŒìŠ¤ ìµœì í™”
    â”œâ”€ ë¶ˆí•„ìš”í•œ ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ í•´ì œ
    â”œâ”€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ
    â”œâ”€ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì •ë¦¬
    â””â”€ ë¹„ìš© ì ˆì•½ íš¨ê³¼
```

**ë¹„ìš© ì ˆì•½**: ì›”ê°„ ì•½ $15-25 ì ˆì•½ (Pod 1ê°œ ê°ì†Œ)

---

## ğŸ›¡ï¸ ì‹œë‚˜ë¦¬ì˜¤ 4: ì„œë²„ ì¥ì•  ë°œìƒ ì‹œ ìë™ ë³µêµ¬ ê³¼ì •

### âš ï¸ 1ë‹¨ê³„: ì¥ì•  ê°ì§€

**ìƒí™©**: íŠ¹ì • Podì—ì„œ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ í¬ë˜ì‹œ

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ì• í”Œë¦¬ì¼€ì´ì…˜ í¬ë˜ì‹œ ë°œìƒ
    â”œâ”€ Python í”„ë¡œì„¸ìŠ¤ ë©”ëª¨ë¦¬ í•œê³„ ì´ˆê³¼
    â”œâ”€ OOMKilled (Out of Memory Killed) ë°œìƒ
    â”œâ”€ ì»¨í…Œì´ë„ˆ exit code: 137
    â””â”€ Pod ìƒíƒœ: CrashLoopBackOff
    â†“
Kubernetes í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨
    â”œâ”€ Liveness Probe ì‹¤í–‰:
    â”‚   â”œâ”€ GET http://pod-ip:8000/health
    â”‚   â”œâ”€ ì—°ê²° íƒ€ì„ì•„ì›ƒ (10ì´ˆ)
    â”‚   â””â”€ 3íšŒ ì—°ì† ì‹¤íŒ¨ ê°ì§€
    â”œâ”€ Readiness Probe ì‹¤í–‰:
    â”‚   â”œâ”€ GET http://pod-ip:8000/health
    â”‚   â”œâ”€ ì—°ê²° ê±°ë¶€
    â”‚   â””â”€ Podë¥¼ Serviceì—ì„œ ì œì™¸
    â””â”€ Pod ìƒíƒœ: Not Ready
    â†“
LoadBalancer ìë™ ëŒ€ì‘
    â”œâ”€ í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨ Pod ê°ì§€
    â”œâ”€ ë°±ì—”ë“œ í’€ì—ì„œ í•´ë‹¹ Pod ì œê±°
    â”œâ”€ ê¸°ì¡´ ì—°ê²° ê°•ì œ ì¢…ë£Œ
    â”œâ”€ ìƒˆ ìš”ì²­ì„ ì •ìƒ Podë¡œë§Œ ë¼ìš°íŒ…
    â””â”€ ì‚¬ìš©ì íŠ¸ë˜í”½ ë³´í˜¸
```

### ğŸ”„ 2ë‹¨ê³„: ìë™ ë³µêµ¬ ì‹¤í–‰

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
Kubernetes ì»¨íŠ¸ë¡¤ëŸ¬ ë³µêµ¬ ì‹œì‘
    â”œâ”€ ReplicaSet ì»¨íŠ¸ë¡¤ëŸ¬ í™œì„±í™”
    â”œâ”€ ì›í•˜ëŠ” ìƒíƒœ í™•ì¸ (replicas: 1)
    â”œâ”€ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Pod ìˆ˜ í™•ì¸ (0ê°œ)
    â”œâ”€ ì°¨ì´ ê°ì§€: 1ê°œ Pod ë¶€ì¡±
    â””â”€ ìƒˆ Pod ìƒì„± ëª…ë ¹
    â†“
Pod ì¬ìƒì„± ê³¼ì •
    â”œâ”€ ê¸°ì¡´ ë¬¸ì œ Pod ì‚­ì œ
    â”œâ”€ ìƒˆ Pod ìŠ¤ì¼€ì¤„ë§
    â”œâ”€ ë™ì¼í•œ ë…¸ë“œ ë˜ëŠ” ë‹¤ë¥¸ ë…¸ë“œì— ë°°ì¹˜
    â”œâ”€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì¬ë‹¤ìš´ë¡œë“œ (í•„ìš”ì‹œ)
    â””â”€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘
    â†“
Secret Manager ê¶Œí•œ ìë™ ë³µêµ¬
    â”œâ”€ Workload Identity ì¬ì„¤ì •
    â”œâ”€ ai-agent-ksa ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ ì¬ë°”ì¸ë”©
    â”œâ”€ Secret Manager ì ‘ê·¼ ê¶Œí•œ í™•ì¸
    â”œâ”€ ANTHROPIC_API_KEY ìë™ ì£¼ì…
    â””â”€ í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ
    â†“
Firestore ì—°ê²° ìë™ ë³µêµ¬
    â”œâ”€ Firestore í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
    â”œâ”€ ai-agent-gke-sa ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ ì¸ì¦
    â”œâ”€ roles/datastore.user ê¶Œí•œ í™•ì¸
    â”œâ”€ ì—°ê²° í…ŒìŠ¤íŠ¸ (ê°„ë‹¨í•œ ì¿¼ë¦¬)
    â””â”€ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ í™•ì¸
    â†“
ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ í™•ì¸
    â”œâ”€ FastAPI ì„œë²„ ì‹œì‘ ì™„ë£Œ
    â”œâ”€ Health Check ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ
    â”œâ”€ ëª¨ë“  ì˜ì¡´ì„± ì„œë¹„ìŠ¤ ì—°ê²° í™•ì¸
    â””â”€ Ready ìƒíƒœ ì „í™˜
```

### âœ… 3ë‹¨ê³„: ì„œë¹„ìŠ¤ ì •ìƒí™”

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
LoadBalancer ë°±ì—”ë“œ ë³µêµ¬
    â”œâ”€ ìƒˆ Pod Health Check ì„±ê³µ ê°ì§€
    â”œâ”€ ì—°ì† 3íšŒ ì„±ê³µ í™•ì¸
    â”œâ”€ ë°±ì—”ë“œ í’€ì— Pod ì¶”ê°€
    â”œâ”€ íŠ¸ë˜í”½ ë¼ìš°íŒ… ì¬ì‹œì‘
    â””â”€ ë¶€í•˜ ë¶„ì‚° ì •ìƒí™”
    â†“
ì‚¬ìš©ì ì—°ê²° ë³µêµ¬
    â”œâ”€ ê¸°ì¡´ ì‚¬ìš©ì ì„¸ì…˜ ìƒíƒœ í™•ì¸
    â”œâ”€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì„¸ì…˜ ì •ë³´ ìœ ì§€ë¨
    â”œâ”€ ìë™ ì¬ì—°ê²° ì‹œë„ (WebSocket)
    â”œâ”€ ì—°ê²° ì„±ê³µ ë° ì„¸ì…˜ ë³µì›
    â””â”€ ì‚¬ìš©ì ê²½í—˜ ì—°ì†ì„± ë³´ì¥
    â†“
ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
    â”œâ”€ Firestore ë°ì´í„° ì†ì‹¤ ì—†ìŒ í™•ì¸
    â”œâ”€ ì§„í–‰ ì¤‘ì´ë˜ íŠ¸ëœì­ì…˜ ìƒíƒœ í™•ì¸
    â”œâ”€ ë¯¸ì™„ë£Œ ì‘ì—… ë³µêµ¬ (í•„ìš”ì‹œ)
    â””â”€ ëª¨ë“  ë°ì´í„° ì¼ê´€ì„± ìœ ì§€
    â†“
ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼
    â”œâ”€ ì¥ì•  ë°œìƒ ë¡œê·¸ ê¸°ë¡
    â”œâ”€ ë³µêµ¬ ì‹œê°„ ì¸¡ì • (í‰ê·  30ì´ˆ)
    â”œâ”€ ì‹œìŠ¤í…œ ìƒíƒœ ì •ìƒ í™•ì¸
    â””â”€ ìš´ì˜ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
```

**ë³µêµ¬ ì‹œê°„**: í‰ê·  30ì´ˆ
**ì‚¬ìš©ì ì˜í–¥**: ì¼ì‹œì  ì§€ì—°ë§Œ ê²½í—˜, ë°ì´í„° ì†ì‹¤ ì—†ìŒ

---

## ğŸ”’ ì‹œë‚˜ë¦¬ì˜¤ 5: ë³´ì•ˆ ìœ„í˜‘ ì°¨ë‹¨ ê³¼ì •

### ğŸš¨ 1ë‹¨ê³„: ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ì ‘ê·¼ ê°ì§€

**ìƒí™©**: íŠ¹ì • IPì—ì„œ ì´ˆë‹¹ 100íšŒ API ìš”ì²­ (ì •ìƒ: ì´ˆë‹¹ 1-2íšŒ)

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
GCP LoadBalancer ë³´ì•ˆ ëª¨ë‹ˆí„°ë§
    â”œâ”€ ìš”ì²­ ë¹ˆë„ ë¶„ì„
    â”‚   â”œâ”€ IPë³„ ì´ˆë‹¹ ìš”ì²­ ìˆ˜ ì¶”ì 
    â”‚   â”œâ”€ ì„ê³„ê°’ ì´ˆê³¼ ê°ì§€ (100 RPS > 10 RPS)
    â”‚   â””â”€ ë¹„ì •ìƒ íŒ¨í„´ í™•ì¸
    â”œâ”€ ìš”ì²­ íŒ¨í„´ ë¶„ì„
    â”‚   â”œâ”€ User-Agent í—¤ë” í™•ì¸
    â”‚   â”œâ”€ ë™ì¼í•œ ìš”ì²­ ë°˜ë³µ íŒ¨í„´
    â”‚   â””â”€ ë´‡ íŠ¸ë˜í”½ íŠ¹ì„± ì‹ë³„
    â””â”€ DDoS ê³µê²© íŒ¨í„´ ë§¤ì¹­
    â†“
Cloud Armor ìë™ í™œì„±í™”
    â”œâ”€ ì•…ì„± IP ìë™ ì‹ë³„
    â”œâ”€ ì§€ë¦¬ì  ìœ„ì¹˜ ë¶„ì„
    â”œâ”€ ê³µê²© ìœ í˜• ë¶„ë¥˜ (DDoS, ë¸Œë£¨íŠ¸ í¬ìŠ¤)
    â”œâ”€ ë°©ì–´ ì •ì±… ìë™ ì ìš©
    â””â”€ íŠ¸ë˜í”½ ì°¨ë‹¨ ê·œì¹™ ìƒì„±
    â†“
LoadBalancer ë ˆë²¨ ì°¨ë‹¨
    â”œâ”€ ì˜ì‹¬ IP ë¸”ë™ë¦¬ìŠ¤íŠ¸ ë“±ë¡
    â”œâ”€ í•´ë‹¹ IP ìš”ì²­ ì¦‰ì‹œ ì°¨ë‹¨ (HTTP 429)
    â”œâ”€ ë ˆì´íŠ¸ ë¦¬ë¯¸íŒ… ì ìš©
    â””â”€ ì •ìƒ ì‚¬ìš©ì íŠ¸ë˜í”½ ë³´í˜¸
```

### ğŸ›¡ï¸ 2ë‹¨ê³„: ë‹¤ì¸µ ë³´ì•ˆ ì°¨ë‹¨

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
Secret Manager ë¬´ë‹¨ ì ‘ê·¼ ì°¨ë‹¨
    â”œâ”€ API í‚¤ ì ‘ê·¼ ì‹œë„ ëª¨ë‹ˆí„°ë§
    â”œâ”€ ë¹„ì •ìƒì ì¸ ì ‘ê·¼ íŒ¨í„´ ê°ì§€
    â”œâ”€ ì•¡ì„¸ìŠ¤ ë¡œê·¸ ë¶„ì„
    â”‚   â”œâ”€ ìš”ì²­ ì†ŒìŠ¤ IP í™•ì¸
    â”‚   â”œâ”€ ì¸ì¦ í† í° ìœ íš¨ì„± í™•ì¸
    â”‚   â””â”€ ê¶Œí•œ ë²”ìœ„ ê²€ì¦
    â”œâ”€ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ì ‘ê·¼ ì‹œë„ ì°¨ë‹¨
    â””â”€ ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê·¸ ìƒì„±
    â†“
Firestore ê¶Œí•œ ì‹œìŠ¤í…œ ë³´í˜¸
    â”œâ”€ IAM ì •ì±… ìë™ ê²€ì¦
    â”œâ”€ Workload Identity ë°”ì¸ë”© í™•ì¸
    â”œâ”€ ë¬´ê¶Œí•œ ë°ì´í„° ì ‘ê·¼ ì‹œë„ ì°¨ë‹¨
    â”œâ”€ ì‚¬ìš©ìë³„ ë°ì´í„° ê²©ë¦¬ í™•ì¸
    â””â”€ ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥
    â†“
Kubernetes ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ
    â”œâ”€ Pod ê°„ í†µì‹  ì •ì±… í™•ì¸
    â”œâ”€ ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ ì œí•œ
    â”œâ”€ ì„œë¹„ìŠ¤ ê°„ mTLS í†µì‹  í™•ì¸
    â””â”€ ì»¨í…Œì´ë„ˆ ê²©ë¦¬ ìœ ì§€
    â†“
ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ë³´ì•ˆ
    â”œâ”€ FastAPI ìš”ì²­ ê²€ì¦ ê°•í™”
    â”œâ”€ SQL ì¸ì ì…˜ ë°©ì§€ í™•ì¸
    â”œâ”€ XSS ê³µê²© ë°©ì§€ í—¤ë” í™•ì¸
    â”œâ”€ ì…ë ¥ ë°ì´í„° ê²€ì¦ ê°•í™”
    â””â”€ ì„¸ì…˜ í•˜ì´ì¬í‚¹ ë°©ì§€
```

### âœ… 3ë‹¨ê³„: ì •ìƒ ì‚¬ìš©ì ë³´í˜¸

**ê¸°ìˆ  ìƒí˜¸ì‘ìš© íë¦„**:
```
ì •ìƒ íŠ¸ë˜í”½ ì‹ë³„ ë° ìš°ì„  ì²˜ë¦¬
    â”œâ”€ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IP ìš°ì„  ì²˜ë¦¬
    â”œâ”€ ì •ìƒ ì‚¬ìš©ì íŒ¨í„´ í•™ìŠµ
    â”œâ”€ ì„¸ì…˜ ê¸°ë°˜ ì‚¬ìš©ì ì¸ì¦
    â””â”€ ìš°ì„  ì²˜ë¦¬ í ìš´ì˜
    â†“
ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ë³´í˜¸
    â”œâ”€ CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ëª¨ë‹ˆí„°ë§
    â”œâ”€ ê³µê²©ìœ¼ë¡œ ì¸í•œ ë¦¬ì†ŒìŠ¤ ê³ ê°ˆ ë°©ì§€
    â”œâ”€ ìë™ ìŠ¤ì¼€ì¼ë§ìœ¼ë¡œ ì¶”ê°€ ë¦¬ì†ŒìŠ¤ í™•ë³´
    â””â”€ ì„œë¹„ìŠ¤ í’ˆì§ˆ ìœ ì§€
    â†“
ì‹¤ì‹œê°„ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§
    â”œâ”€ ê³µê²© íŒ¨í„´ ì§€ì† ëª¨ë‹ˆí„°ë§
    â”œâ”€ ìƒˆë¡œìš´ ìœ„í˜‘ íƒì§€
    â”œâ”€ ë³´ì•ˆ ì •ì±… ë™ì  ì—…ë°ì´íŠ¸
    â””â”€ ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê·¸ ì €ì¥
    â†“
ì‚¬í›„ ë¶„ì„ ë° ê°œì„ 
    â”œâ”€ ê³µê²© ë²¡í„° ë¶„ì„
    â”œâ”€ ë³´ì•ˆ ì •ì±… ê°œì„  ì‚¬í•­ ë„ì¶œ
    â”œâ”€ ë°©ì–´ ì‹œìŠ¤í…œ ì„±ëŠ¥ í‰ê°€
    â””â”€ ë³´ì•ˆ ê°•í™” ê³„íš ìˆ˜ë¦½
```

**ì°¨ë‹¨ íš¨ê³¼**: 99.9% ì•…ì„± íŠ¸ë˜í”½ ì°¨ë‹¨, ì •ìƒ ì‚¬ìš©ì ì˜í–¥ ì—†ìŒ

---

## ğŸ”„ ê¸°ìˆ  ê°„ ìƒí˜¸ì‘ìš© íë¦„ë„

### ğŸ“Š ì¼ë°˜ì ì¸ API ìš”ì²­ ì²˜ë¦¬ íë¦„

```mermaid
graph TD
    A[ì‚¬ìš©ì ë¸Œë¼ìš°ì €] --> B[ì¸í„°ë„·]
    B --> C[GCP LoadBalancer<br/>34.64.193.42]
    C --> D[Kubernetes Service<br/>ai-agent-service]
    D --> E[Kubernetes Pod<br/>ai-agent-api-xxx]
    E --> F[FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜<br/>main.py]
    F --> G[Workload Identity<br/>ê¶Œí•œ í™•ì¸]
    G --> H[Secret Manager<br/>API í‚¤ ì¡°íšŒ]
    F --> I[Firestore<br/>ë°ì´í„° ì²˜ë¦¬]
    I --> F
    F --> E
    E --> D
    D --> C
    C --> B
    B --> A

    style C fill:#e1f5fe
    style E fill:#f3e5f5
    style F fill:#e8f5e8
    style I fill:#fff3e0
```

### ğŸ’¬ ì‹¤ì‹œê°„ WebSocket ì²˜ë¦¬ íë¦„

```mermaid
graph TD
    A[ì‚¬ìš©ì ì…ë ¥] --> B[WebSocket ì—°ê²°]
    B --> C[LoadBalancer<br/>WebSocket í”„ë¡ì‹œ]
    C --> D[Kubernetes Pod<br/>WebSocket í•¸ë“¤ëŸ¬]
    D --> E[FastAPI<br/>ì‹¤ì‹œê°„ ì²˜ë¦¬]
    
    E --> F[ì‚¬ìš©ì ì„¸ì…˜ ê´€ë¦¬]
    E --> G[Firestore<br/>ëŒ€í™” ì €ì¥]
    E --> H[AI ì²˜ë¦¬<br/>ì‹œë®¬ë ˆì´ì…˜]
    
    F --> I[ì‘ë‹µ ìƒì„±]
    G --> I
    H --> I
    
    I --> D
    D --> C
    C --> B
    B --> J[ì‚¬ìš©ì í™”ë©´<br/>ì¦‰ì‹œ í‘œì‹œ]

    style B fill:#e3f2fd
    style E fill:#e8f5e8
    style G fill:#fff3e0
    style H fill:#fce4ec
```

### âš¡ ìë™ ìŠ¤ì¼€ì¼ë§ ì²˜ë¦¬ íë¦„

```mermaid
graph TD
    A[íŠ¸ë˜í”½ ì¦ê°€] --> B[Metrics Server<br/>CPU/ë©”ëª¨ë¦¬ ìˆ˜ì§‘]
    B --> C[HPA<br/>ìŠ¤ì¼€ì¼ë§ ê²°ì •]
    C --> D[Kubernetes API<br/>Pod ìƒì„± ëª…ë ¹]
    D --> E[GKE Autopilot<br/>ë¦¬ì†ŒìŠ¤ í• ë‹¹]
    E --> F[ìƒˆ Pod ìƒì„±]
    F --> G[Secret Manager<br/>ê¶Œí•œ ì„¤ì •]
    F --> H[Firestore<br/>ì—°ê²° ì„¤ì •]
    F --> I[LoadBalancer<br/>ë°±ì—”ë“œ ì¶”ê°€]
    
    G --> J[ì„œë¹„ìŠ¤ Ready]
    H --> J
    I --> J
    
    J --> K[íŠ¸ë˜í”½ ë¶„ì‚°<br/>ì¬ì‹œì‘]

    style C fill:#ffecb3
    style E fill:#e1f5fe
    style J fill:#e8f5e8
```

---

## ğŸ“Š ì„±ëŠ¥ ì§€í‘œ ë° ëª¨ë‹ˆí„°ë§

### â±ï¸ ì‘ë‹µ ì‹œê°„ ë¶„ì„

| ì‘ì—… | í‰ê·  ì‹œê°„ | ê´€ë ¨ ê¸°ìˆ  | ë³‘ëª© ì§€ì  |
|------|-----------|-----------|-----------|
| **í˜ì´ì§€ ë¡œë”©** | 500ms | LoadBalancer, FastAPI, ì •ì íŒŒì¼ | ë„¤íŠ¸ì›Œí¬ ì§€ì—° |
| **ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ìƒì„±** | 300ms | FastAPI, Firestore | ë°ì´í„°ë² ì´ìŠ¤ ì“°ê¸° |
| **ì—ì´ì „íŠ¸ ìƒì„±** | 800ms | FastAPI, Firestore, ë°ì´í„° ê²€ì¦ | Firestore íŠ¸ëœì­ì…˜ |
| **ì—ì´ì „íŠ¸ ëª©ë¡ ì¡°íšŒ** | 400ms | FastAPI, Firestore ì¿¼ë¦¬ | ì¸ë±ìŠ¤ ê²€ìƒ‰ |
| **ì‹¤ì‹œê°„ ë©”ì‹œì§€** | 200ms | WebSocket, ì‹œë®¬ë ˆì´ì…˜ ì²˜ë¦¬ | ì‘ë‹µ ìƒì„± |

### ğŸ“ˆ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰

| ë¦¬ì†ŒìŠ¤ | ì •ìƒ ìƒíƒœ | í”¼í¬ ìƒíƒœ | ìë™ ìŠ¤ì¼€ì¼ë§ |
|--------|-----------|-----------|---------------|
| **CPU** | 20-30% | 80-90% | ìƒˆ Pod ìƒì„± |
| **ë©”ëª¨ë¦¬** | 500MB | 1.5GB | ë©”ëª¨ë¦¬ ì œí•œ ëª¨ë‹ˆí„°ë§ |
| **ë„¤íŠ¸ì›Œí¬** | 10 Mbps | 50 Mbps | LoadBalancer ë¶„ì‚° |
| **Firestore** | 100 reads/min | 1000 reads/min | ìë™ í™•ì¥ |

### ğŸ” ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ

1. **ì‚¬ìš©ì ê²½í—˜ ì§€í‘œ**
   - í˜ì´ì§€ ë¡œë”© ì‹œê°„
   - API ì‘ë‹µ ì‹œê°„
   - WebSocket ì—°ê²° ì•ˆì •ì„±
   - ì—ëŸ¬ìœ¨ (< 0.1%)

2. **ì‹œìŠ¤í…œ ì„±ëŠ¥ ì§€í‘œ**
   - Pod CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ 
   - Firestore ì¿¼ë¦¬ ì„±ëŠ¥
   - LoadBalancer ì²˜ë¦¬ëŸ‰
   - ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì‹œê°„

3. **ë³´ì•ˆ ì§€í‘œ**
   - ë¹„ì •ìƒ ì ‘ê·¼ ì‹œë„
   - API í‚¤ ì‚¬ìš© íŒ¨í„´
   - ë°ì´í„° ì ‘ê·¼ ê¶Œí•œ ìœ„ë°˜
   - DDoS ê³µê²© íƒì§€

---

## ğŸ¯ ê²°ë¡ 

AI Agent Platformì˜ ëª¨ë“  ì‚¬ìš©ì ìƒí˜¸ì‘ìš©ì€ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ìˆ  ìŠ¤íƒì„ í†µí•´ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤:

### ğŸ”„ í•µì‹¬ ê¸°ìˆ  íë¦„
1. **ì‚¬ìš©ì ìš”ì²­** â†’ LoadBalancer (íŠ¸ë˜í”½ ë¶„ì‚°)
2. **LoadBalancer** â†’ Kubernetes Service (ì„œë¹„ìŠ¤ ë¼ìš°íŒ…)  
3. **Kubernetes Service** â†’ Pod (ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰)
4. **Pod** â†’ FastAPI (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬)
5. **FastAPI** â†’ Firestore (ë°ì´í„° ì €ì¥/ì¡°íšŒ)
6. **ì‘ë‹µ ìƒì„±** â†’ ì—­ìˆœìœ¼ë¡œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬

### âš¡ ìë™í™” ì‹œìŠ¤í…œ
- **ìë™ ìŠ¤ì¼€ì¼ë§**: ì‚¬ìš©ì ì¦ê°€ ì‹œ Pod ìë™ í™•ì¥
- **ìë™ ë³µêµ¬**: ì¥ì•  ë°œìƒ ì‹œ 30ì´ˆ ë‚´ ìë™ ë³µêµ¬
- **ìë™ ë³´ì•ˆ**: ì•…ì„± íŠ¸ë˜í”½ ì‹¤ì‹œê°„ ì°¨ë‹¨
- **ìë™ ë°±ì—…**: Firestore ë°ì´í„° ìë™ ë³´í˜¸

### ğŸ”’ ë³´ì•ˆ ë‹¤ì¸µ ë°©ì–´
- **ë„¤íŠ¸ì›Œí¬ ë ˆë²¨**: LoadBalancer + Cloud Armor
- **ì¸ì¦ ë ˆë²¨**: Workload Identity + Secret Manager  
- **ë°ì´í„° ë ˆë²¨**: Firestore IAM + ì•”í˜¸í™”
- **ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨**: FastAPI ë³´ì•ˆ ê²€ì¦

ì´ëŸ¬í•œ ê¸°ìˆ  ìƒí˜¸ì‘ìš©ì„ í†µí•´ ì‚¬ìš©ìëŠ” ë³µì¡í•œ ì¸í”„ë¼ë¥¼ ì˜ì‹í•˜ì§€ ì•Šê³ ë„ ì•ˆì •ì ì´ê³  ë¹ ë¥¸ AI ì—ì´ì „íŠ¸ í”Œë«í¼ì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.